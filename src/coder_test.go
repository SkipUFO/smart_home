package main

import (
	"testing"

	"github.com/stretchr/testify/assert"
)

func TestEncode(t *testing.T) {

	assert.Equal(t,
		"562051010400565754070409535050720003565654010504575751010072535251010400575655770408572751010170565654010504575751700001535055760400572655060003522351017601582127037001255221707601232027037004255221067601235051037601585651767601582151010575",
		encode(encryptKey, `{"auth":"true", "admin":true, "name":"Мамлеев Д.М"}`))

	assert.Equal(t,
		"562051010400565754070409535050720003565654010504575751010575",
		encode(encryptKey, `{"auth":"true"}`))

	assert.Equal(t, "", encode(encryptKey, `{"getalldevices":"true"}`))
}

func TestDecode(t *testing.T) {
	assert.Equal(t,
		`{"auth":"true", "admin":true, "name":"Мамлеев Д.М"}`,
		decode(encryptKey, "562051010400565754070409535050720003565654010504575751010072535251010400575655770408572751010170565654010504575751700001535055760400572655060003522351017601582127037001255221707601232027037004255221067601235051037601585651767601582151010575"))

	assert.Equal(t,
		`{"auth":"true"}`,
		decode(encryptKey, "562051010400565754070409535050720003565654010504575751010575"))
}
